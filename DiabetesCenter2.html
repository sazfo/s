<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saved Data</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <style>
         body {
            font-family: Arial, sans-serif;
           /* background-image: linear-gradient(#348CD2, #FFFFFF, #348CD2), url('../images/0.jpg');*/
            margin: 0;
            display: flex;
                background-color: #ddd;

        }

        .sidebar-container {
            display: flex;
    position: fixed;
    left: 10px;
    top: 15px;
    bottom: 30px; 
    height: calc(100vh - 40px); 
    background-color: white;
    border-radius: 20px; 
    overflow: hidden;
    width: 90px;
            box-shadow: 0 15px 15px rgba(0, 0, 0, 0.2);

}

.narrow-sidebar {
    width: 60px;
    background-color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px 0;
    
}

        .narrow-sidebar .icon {
            font-size: 30px;
            margin: 20px 0;
           color: #4fa3c6; 
            transition: color 0.3s ease;
            cursor: pointer;
            text-decoration: none;
        }

        .narrow-sidebar .icon:hover {
            color: rgb(78, 137, 186);
        }

        .wide-sidebar {
    width: 150px;
    background-color: white;
    color: #4fa3c6; 
    padding: 20px;
    display: flex;
    flex-direction: column;
}
        .wide-sidebar h2 { 
            margin-bottom: 20px; 
            font-size: 22px; 
        }

        .wide-sidebar a {
            color: #4fa3c6; 
            text-decoration: none;
            padding: 10px 0;
            display: block;
            transition: background 0.3s;
        }

        .wide-sidebar a:hover { 
            background: rgba(255, 255, 255, 0.2); 
        }
        .navbar {
            background-color:white;
    padding: 15px;
    color: #4fa3c6; 
    display: flex;
    align-items: center;
    justify-content: space-between; 
    position: fixed;
    top: 10px;
    /*left: 270px;*/
    left: 130px;
    right: 10px;
    z-index: 1001;
    border-radius: 20px;
        box-shadow: 0 15px 15px rgba(0, 0, 0, 0.2);

        }

        .navbar h1 {
          margin: 0;
    text-align: center;
    font-size: 40px;
    flex-grow: 1; 
        }

        .button-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .navbar select {
            padding: 10px;
            margin: 10px;
            font-size: 16px;
            color:#4fa3c6; 
            border-radius: 5px;
        }

        .content {
            margin-left: 210px; 
            margin-top: 80px; 
            width: calc(100% - 210px);
            padding: 20px;
        }

        table {
            width: 95%;
            margin: 40px auto;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            font-size: 14px;
            border-radius: 35px;
                    overflow: hidden;


            
            
        }

        th, td {
            padding: 10px 10px;
            border: 1px solid #ddd;
            text-align: center;
            
        }

        th {
            background-color: #4fa3c6; 
            color: white;
        }

        th:first-child, td:first-child {
            width: 500px; 
            word-wrap: break-word;
        }

        .content {
            margin-left: 150px; 
            margin-right: 45px; 

            margin-top: 100px; 
            width: calc(100% - 210px);
            padding: 20px;
        }

        button {
            background-color:#007bff; 
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            float: right;
        }

        button:hover {
            background-color: #dde5ee;
        }
#summaryTable td:first-child {
  background-color: #a6d3e7; 
  font-weight: bold; 
  }
    </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<script>
function downloadTableAsPDF() {
  const table = document.getElementById("summaryTable");
  const selectedYear = document.getElementById("yearSelect").value;

  if (!table || !selectedYear) {
    alert("يرجى اختيار السنة أولاً.");
    return;
  }

  const clone = table.cloneNode(true);

  const container = document.createElement("div");
  container.style.position = "relative";
  container.style.padding = "20px";
  container.style.width = "100%";
  container.style.minHeight = "100vh";
  container.style.boxSizing = "border-box";
  container.style.backgroundImage = "url('images/404.jpg')";
  container.style.backgroundSize = "cover";
  container.style.backgroundRepeat = "no-repeat";
  container.style.backgroundPosition = "center";

  const title = document.createElement("h2");
  title.textContent = "Diabetes Center - " + selectedYear;
  title.style.textAlign = "center";
  title.style.marginBottom = "20px";
  title.style.position = "relative";
  title.style.color = "#000";

  container.appendChild(title);

  clone.style.marginTop = "200px";
  container.appendChild(clone);

  const imagesDiv = document.createElement("div");
  imagesDiv.style.display = "flex";
  imagesDiv.style.justifyContent = "center";
  imagesDiv.style.marginTop = "20px";
  imagesDiv.style.gap = "20px";

  const img1 = document.createElement("img");
  img1.src = "images/k.jpg";
  img1.style.width = "300px";
  img1.style.height = "auto";
  img1.style.position = "absolute";
  img1.style.top = "0";
  img1.style.right = "0";
  img1.style.margin = "10px";

  imagesDiv.appendChild(img1);
  container.appendChild(imagesDiv);

  const bottomLeftImg = document.createElement("img");
  bottomLeftImg.src = "images/2025.jpg";
  bottomLeftImg.style.width = "500px";
  bottomLeftImg.style.position = "absolute";
  bottomLeftImg.style.bottom = "10px";
  bottomLeftImg.style.left = "10px";
  bottomLeftImg.style.zIndex = "10";
  container.appendChild(bottomLeftImg);

  const bottomRightText = document.createElement("div");
bottomRightText.textContent = "Source:Performance Development department";
bottomRightText.style.position = "absolute";
bottomRightText.style.bottom = "60px";
bottomRightText.style.right = "10px";
bottomRightText.style.fontSize = "16px";
bottomRightText.style.color = "rgba(128, 128, 128, 0.5)";
bottomRightText.style.backgroundColor = "transparent";
bottomRightText.style.padding = "5px 10px";
bottomRightText.style.borderRadius = "5px";
bottomRightText.style.zIndex = "10";
container.appendChild(bottomRightText);

const bottomRightText2 = document.createElement("div");
bottomRightText2.textContent = "Contact : 1588";
bottomRightText2.style.position = "absolute";
bottomRightText2.style.bottom = "35px";
bottomRightText2.style.right = "10px";
bottomRightText2.style.fontSize = "16px";
bottomRightText2.style.color = "rgba(128, 128, 128, 0.5)";
bottomRightText2.style.backgroundColor = "transparent";
bottomRightText2.style.padding = "5px 10px";
bottomRightText2.style.borderRadius = "5px";
bottomRightText2.style.zIndex = "10";
container.appendChild(bottomRightText2);

const bottomRightText3 = document.createElement("div");
bottomRightText3.textContent = "At King Saud Hospital Unayzah";
bottomRightText3.style.position = "absolute";
bottomRightText3.style.bottom = "10px";
bottomRightText3.style.right = "10px";
bottomRightText3.style.fontSize = "16px";
bottomRightText3.style.color = "rgba(128, 128, 128, 0.5)";
bottomRightText3.style.backgroundColor = "transparent";
bottomRightText3.style.padding = "5px 10px";
bottomRightText3.style.borderRadius = "5px";
bottomRightText3.style.zIndex = "10";
container.appendChild(bottomRightText3);

  const dateDiv = document.createElement("div");
  const today = new Date().toLocaleDateString("en-US", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric"
  });
  dateDiv.textContent = today;
  dateDiv.style.position = "absolute";
  dateDiv.style.top = "10px";
  dateDiv.style.left = "10px";
  dateDiv.style.fontSize = "30px";
  dateDiv.style.color = "#000";
  dateDiv.style.backgroundColor = "transparent";
  dateDiv.style.padding = "5px 10px";
  dateDiv.style.borderRadius = "5px";

  container.appendChild(dateDiv);

  container.style.transform = "scale(0.8)";
  container.style.transformOrigin = "top left";
  container.style.width = "125%";

  const opt = {
    margin: 0,
    filename: 'Diabetes Center' + selectedYear + '.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: {
      scale: 1,
      scrollX: 0,
      scrollY: 0,
      windowWidth: document.documentElement.scrollWidth,
      windowHeight: document.documentElement.scrollHeight
    },
    jsPDF: { unit: 'in', format: 'a3', orientation: 'landscape' }
  };

  html2pdf().set(opt).from(container).save();
}

</script>



    <div class="sidebar-container">
        <div class="narrow-sidebar">
            <a href="login.html" class="icon"><i class="bi bi-person"></i></a>
            <a href="index.html" class="icon"><i class="bi bi-house-door"></i></a>
            <a href='DiabetesCenter2.html'class="icon"><i class="bi bi-table"></i></a>
            <a href='DiabetesCenter4.html' class="icon"><i class="bi bi-bar-chart-line"></i></a>
                                      <a href="#" class="icon" onclick="downloadTableAsPDF()"><i class="bi bi-save"></i></a>

        </div>
       
    </div>

    <div class="navbar">
        <h1>Diabetes Center</h1>
        <div class="button-container">
            
            <select id="yearSelect">
                <option value="">Year</option>
                
                <option value="2023">2023</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
                <option value="2028">2028</option>
                <option value="2029">2029</option>
                <option value="2030">2030</option>

                
            </select>
        </div>
    </div>

    <div class="content">
        <table id="summaryTable">
            <thead>
                <tr>
                    <th>KPI</th>
                    <th>January</th>
                    <th>February</th>
                    <th>March</th>
                    <th>April</th>
                    <th>May</th>
                    <th>June</th>
                    <th>July</th>
                    <th>August</th>
                    <th>September</th>
                    <th>October</th>
                    <th>November</th>
                    <th>December</th>
                    <th>AVG</th>
                    <th>BENCHMARK 

                        
                    </th>

                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-database.js";
    
        const firebaseConfig = {
            apiKey: "AIzaSyAK3WdokOB8tv2y1RKRLWEWO1J_-gij3E0",
            authDomain: "ltgg-61e7d.firebaseapp.com",
            projectId: "ltgg-61e7d",
            storageBucket: "ltgg-61e7d.firebasestorage.app",
            messagingSenderId: "88767682587",
            appId: "1:88767682587:web:bbdbcda18b33fea76740be"
        };
    
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
    
        async function loadTableData(year) {
  const dbRef = ref(db);
  try {
    const snapshot = await get(child(dbRef, `kpi_data/${year}`));
    const data = snapshot.exists() ? snapshot.val() : null;

    const kpis = [
    "1. Dialectologists to patient ratio",
            "2. Clinical dietitian to patient ratio",
            "3. Diabetes Educator Nurse to patient ratio",
            "4. Foot Care Physicians to patient ratio",
            "5. Clinic Productivity",
            "6. No show rate",
            "7. Waiting time for appointment",
            "8. New Patient Ratio",
            "9. Percentage of Patients Screened for Complications",
            "10.Percentage of patients with HbA1c within the target",
            "11.  Percentage of controlled patients who are referred to PHC",
    ];

    const months = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];

    const tbody = document.querySelector('#summaryTable tbody');
    tbody.innerHTML = '';

    kpis.forEach((kpi, index) => {
      let row = document.createElement('tr');
      let kpiCell = document.createElement('td');
      kpiCell.textContent = kpi;
      row.appendChild(kpiCell);

      let sum = 0, count = 0;

      months.forEach(month => {
  let rawValue = data && data[kpi.replace(/\./g, "_")] && data[kpi.replace(/\./g, "_")][month]
    ? data[kpi.replace(/\./g, "_")][month].value || data[kpi.replace(/\./g, "_")][month]
    : '';
  
  let value = (rawValue === '' || typeof rawValue === 'object') ? '' : rawValue;

  let cell = document.createElement('td');
  cell.textContent = value;  
  setMonthColor(cell, value, kpi); 
  row.appendChild(cell);  

  let num = parseFloat(value);
  if (!isNaN(num)) { 
    sum += num; 
    count++; 
  }
});


let avg = (data && data[kpi.replace(/\./g, "_")] && data[kpi.replace(/\./g, "_")]["Average"])
  ? (data[kpi.replace(/\./g, "_")]["Average"].value && typeof data[kpi.replace(/\./g, "_")]["Average"].value !== 'object' && data[kpi.replace(/\./g, "_")]["Average"].value !== '')
    ? data[kpi.replace(/\./g, "_")]["Average"].value
    : ''
  : (count > 0 ? (sum / count).toFixed(2) : '');

let avgCell = document.createElement('td');
avgCell.textContent = avg;
row.appendChild(avgCell);
setAvgColor(avgCell, avg, index);


      let benchmarkCell = document.createElement('td');
      benchmarkCell.textContent = getBenchmarkValue(kpi);
      row.appendChild(benchmarkCell);

      tbody.appendChild(row);
    });

    let chartData = {};
    kpis.forEach((kpi, index) => {
      chartData[index] = [];
      months.forEach(month => {
        let value = data[kpi.replace(/\./g, "_")] && data[kpi.replace(/\./g, "_")][month]
          ? parseFloat(data[kpi.replace(/\./g, "_")][month].value || data[kpi.replace(/\./g, "_")][month])
          : 0;
        chartData[index].push(isNaN(value) ? 0 : value);
      });
    });

    let savedData = JSON.parse(localStorage.getItem('savedTableData')) || {};
    savedData[year] = chartData;
    localStorage.setItem('savedTableData', JSON.stringify(savedData));

  } catch (error) {
    console.error("Error loading data:", error);
  }
}

function getBenchmarkValue(kpi) {
    const benchmarks = {
        "1. Dialectologists to patient ratio":  "<=0.011",
            "2. Clinical dietitian to patient ratio": "<=0.011",
            "3. Diabetes Educator Nurse to patient ratio":"NA",
            "4. Foot Care Physicians to patient ratio": "NA",
            "5. Clinic Productivity": "NA",
            "6. No show rate": "less than 15%",
            "7. Waiting time for appointment":"0-7Days",
            "8. New Patient Ratio": ">20%",
            "9. Percentage of Patients Screened for Complications":"100%",
            "10.Percentage of patients with HbA1c within the target":">50%",
            "11.  Percentage of controlled patients who are referred to PHC":"more than 100%",
    };
    return benchmarks[kpi] || '';
}

    
       


        window.onload = function() {
    document.getElementById('yearSelect').value = ''; 
    document.querySelector('#summaryTable tbody').innerHTML = '';

    document.getElementById('yearSelect').addEventListener('change', function() {
        let selectedYear = this.value;
        if (selectedYear) {
            localStorage.setItem('selectedYear', selectedYear); 
            loadTableData(selectedYear); 
        } else {
            document.querySelector('#summaryTable tbody').innerHTML = '';
        }
    });
};




    </script>




    
   

   <script>
  window.onload = function() {
    document.getElementById('yearSelect').value = ''; 
    document.querySelector('#summaryTable tbody').innerHTML = '';

    document.getElementById('yearSelect').addEventListener('change', function() {
        let selectedYear = this.value;
        if (selectedYear) {
            localStorage.setItem('selectedYear', selectedYear); 
            loadTableData(selectedYear); 
        } else {
            document.querySelector('#summaryTable tbody').innerHTML = '';
        }
    });
};
   






function getBenchmarkValue(kpi) {
    let benchmarks = {
        "1. Dialectologists to patient ratio":  "<=0.011",
            "2. Clinical dietitian to patient ratio": "<=0.011",
            "3. Diabetes Educator Nurse to patient ratio":"NA",
            "4. Foot Care Physicians to patient ratio": "NA",
            "5. Clinic Productivity": "NA",
            "6. No show rate": "less than 15%",
            "7. Waiting time for appointment":"0-7Days",
            "8. New Patient Ratio": ">20%",
            "9. Percentage of Patients Screened for Complications":"100%",
            "10.Percentage of patients with HbA1c within the target":">50%",
            "11.  Percentage of controlled patients who are referred to PHC":"more than 100%",

        };

            return benchmarks[kpi] || '';
        }

        loadBenchmarkData();
















        

        function setMonthColor(cell, value, kpi) {
            console.log("KPI:", kpi, "Value:", value); 
    if (value === '' || value === null) {
        cell.style.backgroundColor = '';
        cell.style.color = '';
    } else {
        value = parseFloat(value);
        if (isNaN(value)) {
            return;
        }

        if (kpi === "1. Dialectologists to patient ratio") {
            if (value > 0.005) {
        cell.style.backgroundColor = '#007bff'; 
        cell.style.color = 'white';
    } else if (value >= 0.0011 && value <= 0.005) {
        cell.style.backgroundColor = '#77DD77'; 
        cell.style.color = 'white';
    } else if (value > 0.000667 && value < 0.0011) {
        cell.style.backgroundColor = 'yellow'; 
        cell.style.color = 'black';
    } else if (value <= 0.000667) {
        cell.style.backgroundColor = 'red'; 
        cell.style.color = 'white';
    }
}


        if (kpi === "2. Clinical dietitian to patient ratio") {
            if (value > 0.005) {
        cell.style.backgroundColor = '#007bff'; 
        cell.style.color = 'white';
    } else if (value >= 0.0011 && value <= 0.005) {
        cell.style.backgroundColor = '#77DD77'; 
        cell.style.color = 'white';
    } else if (value > 0.000667 && value < 0.0011) {
        cell.style.backgroundColor = 'yellow'; 
        cell.style.color = 'black';
    } else if (value <= 0.000667) {
        cell.style.backgroundColor = 'red'; 
        cell.style.color = 'white';
    }
        }if (kpi === "3. Diabetes Educator Nurse to patient ratio") {
            if (value > 0.005) {
        cell.style.backgroundColor = '#007bff'; 
        cell.style.color = 'white';
    } else if (value >= 0.0011 && value <= 0.005) {
        cell.style.backgroundColor = '#77DD77'; 
        cell.style.color = 'white';
    } else if (value > 0.000667 && value < 0.0011) {
        cell.style.backgroundColor = 'yellow'; 
        cell.style.color = 'black';
    } else if (value <= 0.000667) {
        cell.style.backgroundColor = 'red'; 
        cell.style.color = 'white';
    }
        }if (kpi === "4. Foot Care Physicians to patient ratio") {
            if (value > 0.005) {
        cell.style.backgroundColor = '#007bff'; 
        cell.style.color = 'white';
    } else if (value >= 0.0011 && value <= 0.005) {
        cell.style.backgroundColor = '#77DD77'; 
        cell.style.color = 'white';
    } else if (value > 0.000667 && value < 0.0011) {
        cell.style.backgroundColor = 'yellow'; 
        cell.style.color = 'black';
    } else if (value <= 0.000667) {
        cell.style.backgroundColor = 'red'; 
        cell.style.color = 'white';
    }
        }if (kpi === "5. Clinic Productivity") {
            if (value > 0.005) {
        cell.style.backgroundColor = '#007bff'; 
        cell.style.color = 'white';
    } else if (value >= 0.0011 && value <= 0.005) {
        cell.style.backgroundColor = '#77DD77'; 
        cell.style.color = 'white';
    } else if (value > 0.000667 && value < 0.0011) {
        cell.style.backgroundColor = 'yellow'; 
        cell.style.color = 'black';
    } else if (value <= 0.000667) {
        cell.style.backgroundColor = 'red'; 
        cell.style.color = 'white';
    }
        }if (kpi === "6. No show rate") {
            if (value < 0.15) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 0.15 && value < 0.18) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 0.18 && value <= 0.25) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'white';
} else if (value > 0.25) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

        }if (kpi === "7. Waiting time for appointment") {
            if (value >= 0 && value < 7) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 7 && value < 14) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 14 && value < 21) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (value >= 21) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

        }if (kpi === "8. New Patient Ratio") {
            if (value > 0.20) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 0.15 && value <= 0.20) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 0.10 && value < 0.15) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (value < 0.10) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

        }if (kpi === "9. Percentage of Patients Screened for Complications") {
            if (value >= 1.00) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 0.80 && value < 1.00) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 0.60 && value < 0.80) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (value < 0.60) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

        }if (kpi === "10.Percentage of patients with HbA1c within the target") {
            if (value > 0.50) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 0.30 && value <= 0.50) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 0.20 && value < 0.30) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (value < 0.20) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

        }if (kpi === "11.  Percentage of controlled patients who are referred to PHC") {
            if (value > 1.00) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (value >= 0.80 && value <= 1.00) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (value >= 0.70 && value < 0.80) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (value < 0.70) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}

    }
}}

    
function setAvgColor(cell, avg, index) {
    if (avg === '' || avg === null) {
        cell.style.backgroundColor = '';
        cell.style.color = '';
        return;
    }
    
    avg = parseFloat(avg);
    if (isNaN(avg)) return;
    
    cell.style.backgroundColor = '';
    
    if (index === 0) { 
        if (avg >= 0.033) {
            cell.style.backgroundColor = '#007bff'; 
            cell.style.color = 'white';
        } else if (avg < 0.033 && avg > 0.025) {
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg <= 0.025 && avg > 0.017) {
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 1) { 
        if (avg >= 0.017) {
            cell.style.backgroundColor = '#007bff'; 
            cell.style.color = 'white';
        } else if (avg < 0.017 && avg > 0.013) {
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg <= 0.013 && avg > 0.008) {
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 2) { 
        if (avg === 1.0) {
            cell.style.backgroundColor = '#007bff'; 
            cell.style.color = 'white';
        } else if (avg >= 0.9 && avg < 1.0) {
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg >= 0.7 && avg < 0.9) {
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 3) { 
        if (avg >= 0.10) {
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg > 0.05 && avg < 0.10) {
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 4) { 
        if (avg > 0.05) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg > 0.03 && avg <= 0.05) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 5) { 
        if (avg <= 0.05) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg > 0.05 && avg <= 0.10) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 6) { 
        if (avg >= 0.93) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg >= 0.80 && avg < 0.93) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 7) { 
        if (avg >= 0.80) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg >= 0.60 && avg < 0.80) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 8) { 
        if (avg >= 0.90) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg >= 0.70 && avg < 0.90) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    } else if (index === 9) { 
        if (avg === 1.0) { 
            cell.style.backgroundColor = '#007bff'; 
            cell.style.color = 'white';
        } else if (avg >= 0.90 && avg <= 1.0) { 
            cell.style.backgroundColor = '#77DD77'; 
            cell.style.color = 'white';
        } else if (avg >= 0.70 && avg < 0.90) { 
            cell.style.backgroundColor = 'yellow'; 
            cell.style.color = 'black';
        } else {
            cell.style.backgroundColor = 'red'; 
            cell.style.color = 'white';
        }
    }else if (index === 10) { 
    if (avg > 1.00) {
    cell.style.backgroundColor = '#007bff'; 
    cell.style.color = 'white';
} else if (avg >= 0.80 && avg <= 1.00) {
    cell.style.backgroundColor = '#77DD77'; 
    cell.style.color = 'white';
} else if (avg >= 0.70 && avg < 0.80) {
    cell.style.backgroundColor = 'yellow'; 
    cell.style.color = 'black';
} else if (avg < 0.70) {
    cell.style.backgroundColor = 'red'; 
    cell.style.color = 'white';
}
}
    }














</script>


</body>
</html>
